<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Desarrollo de Aplicaciones Híbridas&#8201;&#8212;&#8201;Máster TAII&#8201;&#8212;&#8201;UAL">
<link rel="icon" type="image/x-icon" href="./images/favicon.ico">
<title>Almacenamiento y recuperación de datos en aplicaciones Ionic</title>
<style>
@import url(http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.0/css/font-awesome.css);
/* normalize.css v2.1.1 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address styling not present in IE 8/9. */
[hidden] { display: none; }

/* ========================================================================== Base ========================================================================== */
/** 1. Prevent system color scheme's background color being used in Firefox, IE, and Opera. 2. Prevent system color scheme's text color being used in Firefox, IE, and Opera. 3. Set default font family to sans-serif. 4. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { background: #fff; /* 1 */ color: #000; /* 2 */ font-family: sans-serif; /* 3 */ -ms-text-size-adjust: 100%; /* 4 */ -webkit-text-size-adjust: 100%; /* 4 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

a:focus { outline: none; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #111111; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #ad141e; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #ad141e; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.5; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Arial, sans-serif; font-weight: normal; font-style: normal; color: #111111; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #5e5e5e; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: "Andale Mono", "monotype.com", "Lucida Console", monospace; font-weight: normal; color: #222222; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.5; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: inherit; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.5; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Print styles.  Inlined to avoid required HTTP connection: www.phpied.com/delay-loading-your-print-css/ Credit to Paul Irish and HTML5 Boilerplate (html5boilerplate.com)
*/
.print-only { display: none !important; }

@media print { * { background: transparent !important; color: #000 !important; /* Black prints faster: h5bp.com/s */ box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; /* h5bp.com/t */ }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.2; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; padding: 2px; white-space: nowrap; background-color: #eeeeee; border: 0 solid #dddddd; -webkit-border-radius: 0; border-radius: 0; text-shadow: none; }

pre, pre > code { line-height: 1.5; color: white; font-family: Monaco, Consolas, "Courier New", Courier, Sans-serif; font-weight: normal; }

kbd.keyseq { color: #555555; }

kbd:not(.keyseq) { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

kbd kbd:first-child { margin-left: 0; }

kbd kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: #090909; }

p a > code:hover { color: #151515; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#header { margin-bottom: 2.5em; }
#header > h1 { color: black; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #6f6f6f; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }

#toctitle { color: #111111; }

@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; }
  #toc.toc2 { position: fixed; width: 20em; left: 0; top: 0; border-right: 1px solid #dddddd; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; }
  #toc.toc2 > ul { font-size: .95em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1.25em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; border-width: 0; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }

#content #toctitle { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", sans-serif; font-size: 1em; padding-left: 0.125em; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.35; }

.sect1 { padding-bottom: 1.25em; }

.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #111111; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #040404; }

.imageblock, .literalblock, .listingblock, .verseblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }

.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #6f6f6f; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }

.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #d9d9d9; box-shadow: 0 1px 8px #d9d9d9; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #111111; margin-top: 0; line-height: 1.5; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock > .content pre, .listingblock > .content pre { background: #333333; border-width: 0; padding: 10px; word-wrap: break-word; }
.literalblock > .content pre.nowrap, .listingblock > .content pre.nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock > .content pre > code, .listingblock > .content pre > code { display: block; }
@media only screen { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.8em; } }
@media only screen and (min-width: 768px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.9em; } }
@media only screen and (min-width: 1280px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 1em; } }

.listingblock > .content { position: relative; }

.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }

.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }

table.pyhltable { border: 0; margin-bottom: 0; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }

.quoteblock { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 1.25em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: inherit; color: #555555; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }

table thead th, table tfoot th { font-weight: bold; }

table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 0; border-radius: 0; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }

table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }

table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }

table.tableblock td .paragraph:last-child p, table.tableblock td > p:last-child { margin-bottom: 0; }

th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }

th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }

th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }

th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }

th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }

th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }

p.tableblock.header { color: #222222; font-weight: bold; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .8em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.qanda > ol > li > p > em:only-child { color: #96111a; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }

.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #ad141e; color: #820f16; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum { display: inline-block; color: white !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }

#toc a {
  text-decoration: none;
}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Almacenamiento y recuperación de datos en aplicaciones Ionic</h1>
<div class="details">
<span id="author" class="author">Desarrollo de Aplicaciones Híbridas&#8201;&#8212;&#8201;Máster TAII&#8201;&#8212;&#8201;UAL</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Tabla de contenidos</div>
<ul class="sectlevel1">
<li><a href="#_uso_a_firebase">1. Uso a Firebase</a></li>
<li><a href="#_creación_de_un_proyecto_en_firebase">2. Creación de un proyecto en Firebase</a></li>
<li><a href="#_activación_del_servicio_de_autenticación">3. Activación del servicio de autenticación</a></li>
<li><a href="#_creación_de_una_base_de_datos">4. Creación de una base de datos</a></li>
<li><a href="#_creación_de_una_aplicación_ionic_que_haga_uso_de_firebase">5. Creación de una aplicación Ionic que haga uso de Firebase</a>
<ul class="sectlevel2">
<li><a href="#_creación_de_un_servicio_para_la_conexión_a_la_base_de_datos">5.1. Creación de un servicio para la conexión a la base de datos</a></li>
<li><a href="#_creación_de_un_servicio_para_la_autenticación">5.2. Creación de un servicio para la autenticación</a></li>
<li><a href="#_creación_de_una_página_para_realizar_el_acceso_a_la_aplicación">5.3. Creación de una página para realizar el acceso a la aplicación</a></li>
<li><a href="#_modificación_del_módulo_de_la_aplicación">5.4. Modificación del módulo de la aplicación</a></li>
<li><a href="#_creación_de_una_página_para_listar_los_productos">5.5. Creación de una página para listar los productos</a></li>
<li><a href="#_creación_de_una_página_para_añadir_nuevos_artículos">5.6. Creación de una página para añadir nuevos artículos</a></li>
</ul>
</li>
<li><a href="#_ejercicio_creación_de_una_aplicación_ionic_con_almacenamiento_y_recuperación_de_datos">6. Ejercicio: Creación de una aplicación Ionic con almacenamiento y recuperación de datos</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_uso_a_firebase">1. Uso a Firebase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Firebase es un servicio en la nube ofrecido por Google que nos facilita el desarrollo de aplicaciones software. En nuestro caso, para el desarrollo de aplicaciones híbridas lo vamos a utilizar para realizar el proceso de autenticación y para disponer de una base de datos común para los usuarios de nuestra aplicación.</p>
</div>
<div class="paragraph">
<p>Para poder hacer uso de Firebase, es necesario disponer de un cuenta de Google. Los proyectos creados con este tipo de servicio se gestionan desde la consola de Firebase (<a href="https://firebase.google.com/console/">enlace</a>).</p>
</div>
<div class="paragraph">
<p>Firebase ofrece dos tipos de productos para llevar a cabo la persistencia de datos: Firebase Realtime Database y Cloud Firestore. Dichos productos tienen diferentes modelos de datos para implementar la persitencia:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Cloud Firestore</strong> es la base de datos más reciente de Firebase para el desarrollo de apps para dispositivos móviles. Aprovecha lo mejor de Realtime Database con un modelo de datos nuevo y más intuitivo. Con Cloud Firestore también se pueden realizar consultas más ricas y rápidas, y el escalamiento se ajusta a un nivel más alto que Realtime Database.</p>
</li>
<li>
<p><strong>Realtime Database</strong> es la base de datos original de Firebase. Es una solución eficiente y de baja latencia destinada a las apps para dispositivos móviles que necesitan estados sincronizados entre los clientes en tiempo real.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Para elegir cuál es la mejor opción, se debe consultar la información ofrecida por Google Firebase en el siguiente <a href="https://firebase.google.com/docs/firestore/rtdb-vs-firestore">enlace</a>. En nuestro caso, el tipo de base de datos que utilizaremos es Cloud Firestore.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creación_de_un_proyecto_en_firebase">2. Creación de un proyecto en Firebase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para utilizar el servicio de autenticación y disponer de una base de datos, debemos crear un proyecto en Firebase desde la consola (<a href="https://console.firebase.google.com/">enlace</a>.</p>
</div>
<div class="paragraph">
<p>Una vez que accedamos a la consola con un usuario de Google (se recomienda utilizar el mismo usuario proporcionado por la Universidad de Almería para acceder a los servicios de Google), debemos crear un nuevo proyecto. Durante la creación, podemos habilitar la recogida de estadísticas para Google Analytics.</p>
</div>
<div class="paragraph">
<p>Una vez creado el proyecto, haremos clic en el icono <code>&lt;/&gt;</code> (Añadir Firebase a tu aplicación web). En la página a la que accedemos, debemos indicar el nombre de nuestra aplicación (por ejemplo, <code>storeapp</code>) y seleccionaremos "Registrar aplicación".</p>
</div>
<div class="paragraph">
<p>Se nos mostrará la información que debemos incluir en nuestra aplicación para hacer uso de Firebase:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">&lt;!-- The core Firebase JS SDK is always required and must be listed first --&gt;
&lt;script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-app.js"&gt;&lt;/script&gt;

&lt;!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries --&gt;
&lt;script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-analytics.js"&gt;&lt;/script&gt;

&lt;script&gt;
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyA0-pRgLxpmVg4TxjVwfLJHSpIYgLxBuGQ",
    authDomain: "testproject-3fc57.firebaseapp.com",
    databaseURL: "https://testproject-3fc57.firebaseio.com",
    projectId: "testproject-3fc57",
    storageBucket: "testproject-3fc57.appspot.com",
    messagingSenderId: "700340168300",
    appId: "1:700340168300:web:e008e62039da1b5e7e1a49",
    measurementId: "G-3DCBX7P938"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
&lt;/script&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para configurar nuestra aplicación Ionic, deberemos modificar el archivo <code>src/environments/environment.ts</code> con la siguiente información:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">export const environment = {
  production: false,
  firebase: {
    apiKey: "AIzaSyA0-pRgLxpmVg4TxjVwfLJHSpIYgLxBuGQ",
    authDomain: "testproject-3fc57.firebaseapp.com",
    databaseURL: "https://testproject-3fc57.firebaseio.com",
    projectId: "testproject-3fc57",
    storageBucket: "testproject-3fc57.appspot.com",
    messagingSenderId: "700340168300"
  }
};</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_activación_del_servicio_de_autenticación">3. Activación del servicio de autenticación</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En la página inicial de nuestro proyecto (o en el menú de la izquierda), seleccionamos "Authentication" y en la página a la que accedemos seleccionamos "Configura el método de inicio de sesión". En este caso, habilitaremos la autenticación a través de correo electrónico, aunque no habilitaremos la opción "Enviar enlace por correo electrónico (inicio de sesión sin contraseña)".</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Para realizar una autenticación a través cuentas de usuario gestionadas por las redes sociales más comunes, puede consultarse el siguiente <a href="https://ionicthemes.com/tutorials/about/firebase-authentication-in-ionic-framework-apps">enlace</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Una vez realizada la activación, debemos crear las cuentas de usuario que podrán acceder a nuestra aplicación. En nuestro caso, crearemos dos usuarios de ejemplo. Cada usuario se corresponderá con un proveedor de productos que tendrá la capacidad de añadir elementos a la aplicación.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creación_de_una_base_de_datos">4. Creación de una base de datos</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En la página inicial de nuestro proyecto seleccionamos Cloud Firestore (o Database en el menú de la izquierda). A continuación, seleccionamos "Crear base de datos" y en las opciones ofrecidas elegimos "Empezar con el modo de prueba" y pulsamos "Siguiente".</p>
</div>
<div class="paragraph">
<p>Para la ubicación donde se guardarán los datos de Cloud Firestore, abrimos el menú desplegable para seleccionar <code>eur3 (europe-west)</code>. Seleccionaremos "Listo" para que se inicie el "Aprovisionamiento en Cloud Firestore&#8230;&#8203;". Al finalizar, se nos habrá creado un espacio de almacenamiento asociado al proyecto anterior.</p>
</div>
<div class="paragraph">
<p>Crearemos una nueva colección de elementos seleccionando "Iniciar colección". Como "ID de colección" escribiremos <code>users</code>. En el siguiente paso, insertaremos un usuario inicial seleccionando "ID automático" y pulsando "Guardar".</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creación_de_una_aplicación_ionic_que_haga_uso_de_firebase">5. Creación de una aplicación Ionic que haga uso de Firebase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En primer lugar, creamos una aplicación Ionic vacía:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ ionic start fireapp blank --type=angular</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para que la aplicación Ionic pueda comunicarse con la base de datos creada en Firebase, sa va a hacer uso del plugin AngularFire (<a href="https://github.com/angular/angularfire">enlace</a>).</p>
</div>
<div class="paragraph">
<p>Para ello, dentro del proyecto, debemos instalar la siguiente dependencia:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ cd fireapp
$ npm install @angular/fire firebase --save</code></pre>
</div>
</div>
<div class="paragraph">
<p>El siguiente paso es modificar el archivo <code>src/environments/environment.ts</code> con las información obtenida de Firebase (ver paso 2).</p>
</div>
<div class="sect2">
<h3 id="_creación_de_un_servicio_para_la_conexión_a_la_base_de_datos">5.1. Creación de un servicio para la conexión a la base de datos</h3>
<div class="paragraph">
<p>Creamos un servicio <code>db</code> para las funciones relativas a la base de datos:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ ionic g service /services/db</code></pre>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>services/db.service.ts</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import { Injectable } from '@angular/core';
import { AngularFirestore } from '@angular/fire/firestore';
import * as firebase from 'firebase/app';
import 'firebase/storage';
import { AngularFireAuth } from '@angular/fire/auth';

@Injectable({
  providedIn: 'root'
})
export class DbService {

  private snapshotChangesSubscription: any;

  constructor(
    public afs: AngularFirestore, <i class="conum" data-value="1"></i><b>(1)</b>
    public afAuth: AngularFireAuth <i class="conum" data-value="2"></i><b>(2)</b>
  ){}

  getProducts(){ <i class="conum" data-value="3"></i><b>(3)</b>
    return new Promise&lt;any&gt;((resolve, reject) =&gt; {
      this.afAuth.user.subscribe(currentUser =&gt; {
        if(currentUser){
          this.snapshotChangesSubscription = this.afs.collection('users').doc(currentUser.uid).collection('products').snapshotChanges();
          resolve(this.snapshotChangesSubscription);
        }
      })
    })
  }

  getProduct(productId){ <i class="conum" data-value="4"></i><b>(4)</b>
    return new Promise&lt;any&gt;((resolve, reject) =&gt; {
      this.afAuth.user.subscribe(currentUser =&gt; {
        if(currentUser){
          this.snapshotChangesSubscription = this.afs.doc&lt;any&gt;('users/' + currentUser.uid + '/products/' + productId).valueChanges()
          .subscribe(snapshots =&gt; {
            resolve(snapshots);
          }, err =&gt; {
            reject(err)
          })
        }
      })
    });
  }

  createProduct(value){ <i class="conum" data-value="5"></i><b>(5)</b>
    return new Promise&lt;any&gt;((resolve, reject) =&gt; {
      let currentUser = firebase.auth().currentUser;
      this.afs.collection('users').doc(currentUser.uid).collection('products').add({
        name: value.name,
        description: value.description,
        image: value.image
      })
      .then(
        res =&gt; resolve(res),
        err =&gt; reject(err)
      )
    })
  }

  updateProduct(productKey, value){ <i class="conum" data-value="6"></i><b>(6)</b>
    return new Promise&lt;any&gt;((resolve, reject) =&gt; {
      let currentUser = firebase.auth().currentUser;
      this.afs.collection('users').doc(currentUser.uid).collection('products').doc(productKey).set(value)
      .then(
        res =&gt; resolve(res),
        err =&gt; reject(err)
      )
    })
  }

  deleteProduct(productKey){ <i class="conum" data-value="7"></i><b>(7)</b>
    return new Promise&lt;any&gt;((resolve, reject) =&gt; {
      let currentUser = firebase.auth().currentUser;
      this.afs.collection('users').doc(currentUser.uid).collection('products').doc(productKey).delete()
      .then(
        res =&gt; resolve(res),
        err =&gt; reject(err)
      )
    })
  }

  unsubscribeOnLogOut(){ <i class="conum" data-value="8"></i><b>(8)</b>
    this.snapshotChangesSubscription.unsubscribe();
  }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Objeto que gestiona el acceso a los datos de Cloud Firestore</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Objeto que gestiona la autorización de usuario a través de Firebase</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Obtención de todos los productos del usuario</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Obtención de los datos de un producto</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Creación de un nuevo producto para el usuario</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Modificación de un producto</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Eliminación de un producto</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Cancelación de la suscripción que obtiene los datos dinámicamente</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creación_de_un_servicio_para_la_autenticación">5.2. Creación de un servicio para la autenticación</h3>
<div class="paragraph">
<p>Creamos un servicio <code>auth</code> para las funciones de autenticación:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ ionic g service /services/auth</code></pre>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>services/auth.service.ts</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import { Injectable } from '@angular/core';
import * as firebase from 'firebase/app';
import { DbService } from './db.service';
import { AngularFireAuth } from '@angular/fire/auth';

@Injectable({
  providedIn: 'root'
})
export class AuthService {

  constructor(
    private dbService: DbService, <i class="conum" data-value="1"></i><b>(1)</b>
    public afAuth: AngularFireAuth <i class="conum" data-value="2"></i><b>(2)</b>
  ){}

  doLogin(value){ <i class="conum" data-value="3"></i><b>(3)</b>
   return new Promise&lt;any&gt;((resolve, reject) =&gt; {
     firebase.auth().signInWithEmailAndPassword(value.email, value.password)
     .then(
       res =&gt; resolve(res),
       err =&gt; reject(err))
   })
  }

  doLogout(){ <i class="conum" data-value="4"></i><b>(4)</b>
    return new Promise((resolve, reject) =&gt; {
      this.afAuth.auth.signOut()
      .then(() =&gt; {
        this.dbService.unsubscribeOnLogOut();
        resolve();
      }).catch((error) =&gt; {
        console.log(error);
        reject();
      });
    })
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Objeto que gestiona el servicio para acceder a las funciones que operan sobre la base de datos</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Objeto que gestiona la autorización de usuario a través de Firebase</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Inicio de sesión a través de Firebase <code>signInWithEmailAndPassword</code></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Cierre de sesión a través de Firebase mediante la función <code>signOut</code></td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creación_de_una_página_para_realizar_el_acceso_a_la_aplicación">5.3. Creación de una página para realizar el acceso a la aplicación</h3>
<div class="paragraph">
<p>Creamos una nueva página <code>login</code> para poder introducir los datos de acceso:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ ionic g page login</code></pre>
</div>
</div>
<div class="paragraph">
<p>Modificaremos la definición del componente:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>login/login.page.ts</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import { Component, OnInit } from '@angular/core';
import { Validators, FormBuilder, FormGroup, FormControl } from '@angular/forms';
import { AuthService } from '../services/auth.service';
import { Router } from '@angular/router';

@Component({
  selector: 'app-login',
  templateUrl: './login.page.html',
  styleUrls: ['./login.page.scss'],
})
export class LoginPage implements OnInit {

  formValidation: FormGroup; <i class="conum" data-value="1"></i><b>(1)</b>
  errorMessage: string = ''; <i class="conum" data-value="2"></i><b>(2)</b>

  formValidationMessages = { <i class="conum" data-value="3"></i><b>(3)</b>
   'email': [
     { type: 'required', message: 'El email es un campo obligatorio.' },
     { type: 'pattern', message: 'El formato del email no es correcto.' }
   ],
   'password': [
     { type: 'required', message: 'La contraseña es un campo obligatorio.' },
     { type: 'minlength', message: 'La lóngitud mínima de una contraseña es 6 caracteres.' }
   ]
 };

  constructor(
    private authService: AuthService, <i class="conum" data-value="4"></i><b>(4)</b>
    private formBuilder: FormBuilder, <i class="conum" data-value="5"></i><b>(5)</b>
    private router: Router <i class="conum" data-value="6"></i><b>(6)</b>
  ) { }

  ngOnInit() {
    this.formValidation = this.formBuilder.group({
      email: new FormControl('', Validators.compose([
        Validators.required,
        Validators.pattern('^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+$')
      ])),
      password: new FormControl('', Validators.compose([
        Validators.minLength(6),
        Validators.required
      ])),
    });
  }

  tryLogin(value){ <i class="conum" data-value="7"></i><b>(7)</b>
    this.authService.doLogin(value)
    .then(res =&gt; {
      this.router.navigate(["/products"]);
    }, err =&gt; {
      this.errorMessage = err.message;
      console.log(err);
    })
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Declaración del formulario para su interacción con la vista del componente</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Mensaje de error que se muestra en caso de que el inicio de sesión no se realice de forma correcta</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Mensajes de error que se muestran durante la validación de los datos introducidos en el formulario</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Objeto para gestionar la autenticación mediante Firebase</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Objeto para gestionar la construcción y validación de los del formulario</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Objeto para realizar la navegación a la página específica cuando se ejecute el inicio de sesión de forma correcta</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Comprobación de la autenticación del usuario y navegación a una nueva página cuando la autenticación es correcta</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>También modificaremos a plantilla HTML del componente:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>login/login.page.html</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;ion-header&gt;
  &lt;ion-toolbar&gt;
    &lt;ion-title&gt;Login&lt;/ion-title&gt;
  &lt;/ion-toolbar&gt;
&lt;/ion-header&gt;

&lt;ion-content&gt;

  &lt;form class="form" [formGroup]="formValidation" (ngSubmit)="tryLogin(formValidation.value)"&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;ion-item&gt;
      &lt;ion-label class="label-title"&gt;Introduzca sus datos para acceder a la aplicación:&lt;/ion-label&gt;
    &lt;/ion-item&gt;
    &lt;ion-item&gt;
      &lt;ion-label position="floating" color="primary"&gt;Email: &lt;/ion-label&gt;
      &lt;ion-input type="text" formControlName="email"&gt;&lt;/ion-input&gt;
    &lt;/ion-item&gt;
    &lt;div&gt; <i class="conum" data-value="2"></i><b>(2)</b>
      &lt;ng-container *ngFor="let validation of formValidationMessages.email"&gt;
        &lt;div class="error-message" *ngIf="formValidation.get('email').hasError(validation.type) &amp;&amp; (formValidation.get('email').dirty || formValidation.get('email').touched)"&gt;
          {{ validation.message }}
        &lt;/div&gt;
      &lt;/ng-container&gt;
    &lt;/div&gt;
    &lt;ion-item&gt;
      &lt;ion-label position="floating" color="primary"&gt;Contraseña: &lt;/ion-label&gt;
      &lt;ion-input type="password"  formControlName="password"&gt;&lt;/ion-input&gt;
    &lt;/ion-item&gt;
    &lt;div&gt; <i class="conum" data-value="3"></i><b>(3)</b>
      &lt;ng-container *ngFor="let validation of formValidationMessages.password"&gt;
        &lt;div class="error-message" *ngIf="formValidation.get('password').hasError(validation.type) &amp;&amp; (formValidation.get('password').dirty || formValidation.get('password').touched)"&gt;
          {{ validation.message }}
        &lt;/div&gt;
      &lt;/ng-container&gt;
    &lt;/div&gt;
    &lt;div class="div-button-login"&gt; <i class="conum" data-value="4"></i><b>(4)</b>
      &lt;ion-button type="submit" [disabled]="!formValidation.valid"&gt;Iniciar sesión&lt;/ion-button&gt;
    &lt;/div&gt;
    &lt;div class="div-label-error"&gt; <i class="conum" data-value="5"></i><b>(5)</b>
     &lt;ion-label class="error-message"&gt;{{ errorMessage }}&lt;/ion-label&gt;
    &lt;/div&gt;
  &lt;/form&gt;

&lt;/ion-content&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Uso de <code>formGroup</code> para vincular los elementos del modelo del componente con los campos de la vista del formulario. Se realiza la llamada a la función <code>tryLogin</code> cuando se realice el envío del formulario</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Mensajes de error durante la validación del email</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Mensajes de error durante la validación de la contraseña</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Botón de envío del formulario</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Mensaje de error durante la validación del inicio de sesión</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>Y el archivo con la definición de estilos:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>login/login.page.scss</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scss" data-lang="scss">.form {
  margin-top: 50px;
}

.label-title {
  font-weight: 500;
  margin-bottom: 20px;
}

.div-button-login {
  text-align: center;
  margin-top: 20px;
}

.div-label-error {
  text-align: center;
  margin-top: 10px;
}

.error-message {
  color: var(--ion-color-danger);
  font-size: smaller;
  padding: 10px;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Además, es necesario modificar el módulo asociado al componente:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>login/login.module.ts</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import { NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';
import { FormsModule, ReactiveFormsModule } from '@angular/forms';

import { IonicModule } from '@ionic/angular';

import { LoginPageRoutingModule } from './login-routing.module';

import { LoginPage } from './login.page';

@NgModule({
  imports: [
    CommonModule,
    FormsModule,
    IonicModule,
    ReactiveFormsModule, <i class="conum" data-value="1"></i><b>(1)</b>
    LoginPageRoutingModule
  ],
  declarations: [LoginPage]
})
export class LoginPageModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Se debe importar <code>ReactiveFormsModule</code> para que el formulario pueda hacer uso de observables para reaccionar dinámicamente a los cambios del formulario (ver <a href="https://angular.io/api/forms/ReactiveFormsModule">enlace</a>)</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modificación_del_módulo_de_la_aplicación">5.4. Modificación del módulo de la aplicación</h3>
<div class="paragraph">
<p>Para que la funcionalidad declarada en el módulo anterior funcione correctamente, es necesario modificar el módulo asociado a la aplicación:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>app.module.ts</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import { NgModule } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { RouteReuseStrategy } from '@angular/router';

import { IonicModule, IonicRouteStrategy } from '@ionic/angular';
import { SplashScreen } from '@ionic-native/splash-screen/ngx';
import { StatusBar } from '@ionic-native/status-bar/ngx';

import { AppComponent } from './app.component';
import { AppRoutingModule } from './app-routing.module';

import { FormsModule, ReactiveFormsModule } from '@angular/forms'; //

import { AngularFireModule } from '@angular/fire'; //
import { environment } from '../environments/environment'; //
import { AngularFirestoreModule, FirestoreSettingsToken } from '@angular/fire/firestore';
import { AngularFireAuthModule } from '@angular/fire/auth';
import { AngularFireStorageModule } from '@angular/fire/storage';

@NgModule({
  declarations: [AppComponent],
  entryComponents: [],
  imports: [
    BrowserModule,
    IonicModule.forRoot(),
    AppRoutingModule,
    FormsModule, <i class="conum" data-value="1"></i><b>(1)</b>
    ReactiveFormsModule, <i class="conum" data-value="2"></i><b>(2)</b>
    AngularFireModule.initializeApp(environment.firebase), <i class="conum" data-value="3"></i><b>(3)</b>
    AngularFirestoreModule, <i class="conum" data-value="4"></i><b>(4)</b>
    AngularFireAuthModule, <i class="conum" data-value="5"></i><b>(5)</b>
    AngularFireStorageModule, <i class="conum" data-value="6"></i><b>(6)</b>
  ],
  providers: [
    StatusBar,
    SplashScreen,
    { provide: FirestoreSettingsToken, useValue: {} }, <i class="conum" data-value="7"></i><b>(7)</b>
    { provide: RouteReuseStrategy, useClass: IonicRouteStrategy }
  ],
  bootstrap: [AppComponent]
})
export class AppModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Importación del módulo para utilizar formularios</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Importación del módulo para utilizar formularios "reactivos"</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Importación e inicialización de AngularFire</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Importación del módulo para utilizar Cloud Firestore</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Importación del módulo para utilizar la autenticación de Firebase</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Importación del módulo para guardar cambios y subir archivos a la base de datos de Firebase</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Proveedor necesario para hacer uso de tokens de sesión de Firebase</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creación_de_una_página_para_listar_los_productos">5.5. Creación de una página para listar los productos</h3>
<div class="paragraph">
<p>Si intentamos probar el acceso a través de la página anterior, nos dará un error puesto que todavía no hemos desarrollado una página accesible a través de la ruta <code>/products</code>. Por ello, crearemos una nueva página llamada <code>products</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ ionic g page products</code></pre>
</div>
</div>
<div class="paragraph">
<p>En esta página se listarán los productos asociados al usuario que lleva a cabo el inicio de sesión en la aplicación. Para ello, realizaremos las siguientes modificaciones en el componente:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>products/products.page.ts</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import { Component, OnInit } from '@angular/core';
import { AuthService } from '../services/auth.service'; //
import { LoadingController } from '@ionic/angular';
import { Router, ActivatedRoute } from '@angular/router';

@Component({
  selector: 'app-products',
  templateUrl: './products.page.html',
  styleUrls: ['./products.page.scss'],
})
export class ProductsPage implements OnInit {

  items: Array&lt;any&gt;;

  constructor(
    public loadingCtrl: LoadingController, <i class="conum" data-value="1"></i><b>(1)</b>
    private authService: AuthService, <i class="conum" data-value="2"></i><b>(2)</b>
    private router: Router, <i class="conum" data-value="3"></i><b>(3)</b>
    private route: ActivatedRoute <i class="conum" data-value="4"></i><b>(4)</b>
  ) { }

  ngOnInit() {
    if (this.route &amp;&amp; this.route.data) {
      this.getData();
    }
  }

  async getData(){ <i class="conum" data-value="5"></i><b>(5)</b>
    const loading = await this.loadingCtrl.create({
      message: 'Por favor, espere...'
    });
    this.presentLoading(loading);

    this.route.data.subscribe(routeData =&gt; { <i class="conum" data-value="6"></i><b>(6)</b>
      routeData['data'].subscribe(data =&gt; {
        loading.dismiss();
        this.items = data;
      })
    })
  }

  async presentLoading(loading) {
    return await loading.present();
  }

  logout(){ <i class="conum" data-value="7"></i><b>(7)</b>
    this.router.navigate(["/home"]);
    this.authService.doLogout()
    .then(res =&gt; {
      console.log("User logout");
    }, err =&gt; {
      console.log(err);
    })
  }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Objeto encargado de controlar la carga de la página</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Objeto utilizado para el cierre de sesión</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Objeto utilizado para navegar hacia la página de <code>home</code> cuando se hace el cierre de sesión</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Ruta de acceso a la página que también contiene los datos a mostrar (productos del usuario)</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Función asíncrona para mostrar un mensaje de espera mientras que se realiza la carga de la página (para dar tiempo a que se realice la consulta a la base de datos)</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Acceso a los datos obtenidos a partir del acceso a la página</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Función para realizar el cierre de sesión y la navegación hacia la página de <code>home</code></td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>La platilla HTML del componente será la siguiente:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>products/products.page.html</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;ion-header&gt;
  &lt;ion-toolbar&gt;
    &lt;ion-buttons slot="end"&gt;
      &lt;ion-button [routerLink]="['/add-product']"&gt;  <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;ion-icon slot="icon-only" name="add"&gt;&lt;/ion-icon&gt;
      &lt;/ion-button&gt;
      &lt;ion-button (click)="logout()"&gt; <i class="conum" data-value="2"></i><b>(2)</b>
        &lt;ion-icon slot="icon-only" name="exit-outline"&gt;&lt;/ion-icon&gt;
      &lt;/ion-button&gt;
    &lt;/ion-buttons&gt;
    &lt;ion-title&gt;Lista de Productos&lt;/ion-title&gt;
  &lt;/ion-toolbar&gt;
&lt;/ion-header&gt;

&lt;ion-content *ngIf="items" class="list-mini-content" padding&gt;
  &lt;div *ngIf="items.length &gt; 0" class="list-mini"&gt;
    &lt;ion-list&gt; <i class="conum" data-value="3"></i><b>(3)</b>
      &lt;ion-item *ngFor="let item of items" [routerLink]="['/details', item.payload.doc.id]"&gt; <i class="conum" data-value="4"></i><b>(4)</b>
        &lt;ion-thumbnail slot="start"&gt;
          &lt;img [src]="item.payload.doc.data().image"&gt;
        &lt;/ion-thumbnail&gt;
        &lt;ion-label&gt;{{item.payload.doc.data().name}}&lt;/ion-label&gt;
        &lt;ion-button fill="clear" slot="end"&gt;Ver detalle&lt;/ion-button&gt;
      &lt;/ion-item&gt;
    &lt;/ion-list&gt;
  &lt;/div&gt;
  &lt;div class="empty-list" *ngIf="items.length == 0"&gt; <i class="conum" data-value="5"></i><b>(5)</b>
    No tiene ningún producto creado.
  &lt;/div&gt;
&lt;/ion-content&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Botón para añadir un nuevo producto</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Botón para cerrar sesión y volver a la página de <code>home</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Lista de productos en la que se muestra la imagen del producto y su nombre</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Enlace a los detalles del producto</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Mensaje que se muestra cuando el usuario no tiene ningún producto asociado</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>Cuando se accede a la ruta <code>/products</code> desde la página de <code>login</code> debemos obtener aquellos productos que se encuentran asociados en la base de datos al usuario que ha accedido a la aplicación. Por ello, es necesario crear un servicio que se encargue de resolver esta lista de productos para incorporar dicha información al enrutamiento.</p>
</div>
<div class="paragraph">
<p>Este tipo de archivos suelen describrirse dentro del módulo que necesita la resolución en el acceso a las rutas de dicho módulo (ver <a href="https://angular.io/guide/router#resolve-guard">enlace</a>). Crearemos el servicio <code>products/products-resolve.service.ts</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>products/products-resolve.service.ts</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import { Injectable } from '@angular/core';
import { Resolve } from '@angular/router';
import { DbService } from '../services/db.service';

@Injectable({
  providedIn: 'root'
})
export class ProductsResolverService implements Resolve&lt;any&gt; {

  constructor(private dbService: DbService) {}

  resolve() { <i class="conum" data-value="1"></i><b>(1)</b>
    return this.dbService.getProducts();
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>La resolución consiste en devolver la lista de productos</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>También es necesario modificar el módulo asociado al componente:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>products/products.module.ts</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import { NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';
import { FormsModule } from '@angular/forms';

import { IonicModule } from '@ionic/angular';

import { ProductsPageRoutingModule } from './products-routing.module';

import { ProductsPage } from './products.page';
import { ProductsResolverService } from './products-resolver.service';

@NgModule({
  imports: [
    CommonModule,
    FormsModule,
    IonicModule,
    ProductsPageRoutingModule
  ],
  declarations: [ProductsPage],
  providers: [ProductsResolverService] <i class="conum" data-value="1"></i><b>(1)</b>
})
export class ProductsPageModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Proveedor del servicio que se utilizará para resolver la lista de productos</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>Y, por último, se debe modificar la siguiente información en la definición de la navegación, es decir, en el archivo <code>products-routing.module.ts</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>products/products-routing.module.ts</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import { NgModule } from '@angular/core';
import { Routes, RouterModule } from '@angular/router';

import { ProductsPage } from './products.page';
import { ProductsResolverService } from './products-resolver.service';

const routes: Routes = [
  {
    path: '',
    component: ProductsPage,
    resolve: {
      data: ProductsResolverService <i class="conum" data-value="1"></i><b>(1)</b>
    }
  }
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule],
})
export class ProductsPageRoutingModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>En la propiedad <code>data</code> de la ruta se incluirá la información recuperada a través del proveedor del servicio <code>ProductsResolverService</code></td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creación_de_una_página_para_añadir_nuevos_artículos">5.6. Creación de una página para añadir nuevos artículos</h3>
<div class="paragraph">
<p>Cuando un usuario autorizado por la aplicación accede por primera vez a su página de productos, comprobará que su lista está vacía. Por ello, el siguiente paso es crear una nueva página que nos permita dar nuevos productos de alta en la base de datos.</p>
</div>
<div class="paragraph">
<p>Crearemos la página <code>add-product</code> con la modificación de los siguientes archivos:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>add-product/add-product.page.ts</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import { Component, OnInit } from '@angular/core';
import { DbService } from '../services/db.service';
import { Validators, FormBuilder, FormGroup, FormControl } from '@angular/forms';
import { Router } from '@angular/router';



@Component({
  selector: 'app-add-product',
  templateUrl: './add-product.page.html',
  styleUrls: ['./add-product.page.scss'],
})
export class AddProductPage implements OnInit {

  formValidation: FormGroup;

  constructor(

    public router: Router,
    private formBuilder: FormBuilder,
    private dbService: DbService,

  ) { }

  ngOnInit() {
    this.resetFields();
  }

  resetFields(){

    this.formValidation = this.formBuilder.group({
      name: new FormControl('', Validators.required),
      description: new FormControl('', Validators.required),
      image: new FormControl('', Validators.required)
    });
  }

  onSubmit(value){ <i class="conum" data-value="1"></i><b>(1)</b>
    let data = {
      name: value.name,
      description: value.description,
      image: value.image
    }
    this.dbService.createProduct(data)
    .then(
      res =&gt; {
        this.router.navigate(["/products"]);
      }
    )
  }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Cuando se envía el formulario, se obtiene los datos del producto y se llama al servicio de la base de datos que se encarga de crear el nuevo documento. Además, posteriormente se navega hacia la página de productos</td>
</tr>
</table>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>add-product/add-product.page.html</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;ion-header&gt;
  &lt;ion-toolbar&gt;
    &lt;ion-buttons slot="start"&gt;
      &lt;ion-back-button defaultHref="products"&gt;&lt;/ion-back-button&gt;
    &lt;/ion-buttons&gt;
    &lt;ion-title&gt;Nuevo Producto&lt;/ion-title&gt;
  &lt;/ion-toolbar&gt;
&lt;/ion-header&gt;

&lt;ion-content&gt;

  &lt;form class="form" [formGroup]="formValidation" (ngSubmit)="onSubmit(formValidation.value)"&gt;
    &lt;ion-item&gt;
      &lt;ion-label position="floating" color="primary"&gt;Nombre:&lt;/ion-label&gt;
      &lt;ion-input type="text" formControlName="name"&gt;&lt;/ion-input&gt;
    &lt;/ion-item&gt;
    &lt;ion-item&gt;
      &lt;ion-label position="floating" color="primary"&gt;Descripción: &lt;/ion-label&gt;
      &lt;ion-input type="text" formControlName="description"&gt;&lt;/ion-input&gt;
    &lt;/ion-item&gt;
    &lt;ion-item&gt;
      &lt;ion-label position="floating" color="primary"&gt;URL de la imagen: &lt;/ion-label&gt;
      &lt;ion-input type="text" formControlName="image"&gt;&lt;/ion-input&gt;
    &lt;/ion-item&gt;
    &lt;div class="div-button-create"&gt;
      &lt;ion-button type="submit" [disabled]="!formValidation.valid"&gt;Crear Producto&lt;/ion-button&gt;
    &lt;/div&gt;
  &lt;/form&gt;
&lt;/ion-content&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Archivo <code>add-product/add-product.module.ts</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import { NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';
import { FormsModule, ReactiveFormsModule } from '@angular/forms';

import { IonicModule } from '@ionic/angular';

import { AddProductPageRoutingModule } from './add-product-routing.module';

import { AddProductPage } from './add-product.page';

@NgModule({
  imports: [
    CommonModule,
    FormsModule,
    ReactiveFormsModule, <i class="conum" data-value="1"></i><b>(1)</b>
    IonicModule,
    AddProductPageRoutingModule
  ],
  declarations: [AddProductPage]
})
export class AddProductPageModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Para poder hacer uso de una funcionalidad dinámica en el validación del formulario</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ejercicio_creación_de_una_aplicación_ionic_con_almacenamiento_y_recuperación_de_datos">6. Ejercicio: Creación de una aplicación Ionic con almacenamiento y recuperación de datos</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Como primera parte del ejercicio, se debe responder a las siguientes preguntas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>¿Cómo se consigue que un usuario acceda solo a los productos que él ha creado?</p>
</li>
<li>
<p>¿Cómo se consigue que las listas de productos se actualicen dinámicamente si se insertan nuevos registros?</p>
</li>
<li>
<p>¿Cómo se podrían crear nuevos usuarios desde nuestra aplicación Ionic sin tener que crearlos a través de la consola de Firebase?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>También se debe modificar la aplicación para cumplir con las siguientes características:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>La página de inicio debe tener dos botones</p>
<div class="ulist">
<ul>
<li>
<p>Un botón para acceder a la página de inicio de sesión</p>
</li>
<li>
<p>Otro botón para acceder a un listado de productos que están a la venta. Dicho listado de productos estarán asociados a un usuario específico. En este listado se mostrará la imagen, el nombre y la descripción, pero no existirá una opción para ver detalles del artículo. Desde la página de este listado no se podrán añadir nuevos productos.</p>
</li>
</ul>
</div>
</li>
<li>
<p>El mensaje de salida cuando el usuario no existe en Firebase o cuando la contraseña no es correcta debe estar personalizado.</p>
</li>
<li>
<p>Se debe implementar la funcionalidad para ver los detalles de un artículo en la página <code>products</code>.</p>
</li>
<li>
<p>Se debe implementar la funcionalidad para eliminar un artículo.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-04-01 19:05:42 +0200
</div>
</div>
</body>
</html>